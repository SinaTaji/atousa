{% load price_filters %}
{% load jformat %}
<div class="status-desc-box">
    {% if status == 'cart' %}
        <p>Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ ÙØ¹Ù„ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ùˆ Ø®Ø±ÛŒØ¯ Ø®ÙˆØ¯ Ø±Ø§ Ù†Ù‡Ø§ÛŒÛŒ Ú©Ù†ÛŒØ¯.</p>
    {% elif status == 'packing' %}
        <p>Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ÛŒ Ú©Ù‡ Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù…Ø§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø§Ø³Øª Ø¨Ø¨ÛŒÙ†ÛŒØ¯</p>
    {% elif status == 'sending' %}
        <p>Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù…ÛŒØªÙˆØ§Ù†Ø¯ Ø³ÙØ§Ø±Ø´ÛŒ Ú©Ù‡ Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„ Ø§Ø³Øª Ø±Ø§ Ø¨Ø¨ÛŒÙ†ÛŒØ¯ Ùˆ Ø¨Ø§ Ú©Ø¯ Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ù„Ø­Ø¸Ù‡ Ø¨Ù‡ Ù„Ø­Ø¸Ù‡ Ø§Ø² Ø¨Ø³ØªÙ‡ Ø®ÙˆØ¯ Ø¨Ø§ Ø®Ø¨Ø±
            Ø¨Ø§Ø´ÛŒØ¯</p>
    {% elif status == 'finished' %}
        <p>Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø®Ø±ÛŒØ¯ Ù‡Ø§ÛŒ Ù…ÙˆÙÙ‚ Ø®ÙˆØ¯ Ø§Ø² Ø¢ØªÙˆØ³Ø§ Ø±Ø§ Ø¨Ø¨ÛŒÙ†ÛŒØ¯</p>
    {% endif %}
</div>
{% if status == 'cart' and cart %}
    <div class="sub-cart">
        <div class="cart-items-o">{% include 'cart/cart_items_partial.html' with item=cart %}</div>
        <a class="sub-cart-img" href="{% url 'orders:cart_detail_page' %}">
            <img src="/static/image/icons/complete-o.png" alt="">Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ ÙØ¹Ù„ÛŒ Ø´Ù…Ø§
        </a>
    </div>
{% else %}
    {% for order in orders %}
        <div class="order-block">
            <div class="invoice-container" id="user-invoice-container">
                {% if status == 'sending' and order.TrackingCode %}
                    <div class="tracking-box">
                        <p><strong>Ú©Ø¯ Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ù…Ø±Ø³ÙˆÙ„Ù‡ Ø´Ù…Ø§ :</strong> {{ order.TrackingCode }}</p>
                        {% if order.shipping_method == 'pishteaz' %}
                            <a class="track-link"
                               href="https://tracking.post.ir/search.aspx?id={{ order.TrackingCode }}" target="_blank">
                                Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ø¯Ø± Ø³Ø§Ù…Ø§Ù†Ù‡ Ù¾Ø³Øª Ø§ÛŒØ±Ø§Ù†
                            </a>
                        {% elif order.shipping_method == 'tipax' %}
                            <a class="track-link" href="https://www.tipax.ir" target="_blank">
                                Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ø¯Ø± Ø³Ø§Ù…Ø§Ù†Ù‡ ØªÛŒÙ¾Ø§Ú©Ø³
                            </a>
                        {% else %}
                            <p>Ù„ÛŒÙ†Ú© Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª.</p>
                        {% endif %}
                    </div>
                {% endif %}
                {% if status == 'packing' %}
                    <p id="packing">Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§ Ù‡Ø³ØªÛŒÙ…. Ø¨Ù‡â€ŒØ¯Ù„ÛŒÙ„ ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø§Ù„Ø§ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ØŒ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø§ÛŒÙ†
                        ÙØ±Ø§ÛŒÙ†Ø¯ ØªØ§ Ø¯Ùˆ Ø±ÙˆØ²
                        Ú©Ø§Ø±ÛŒ Ø²Ù…Ø§Ù† Ø¨Ø¨Ø±Ø¯. Ø§Ø² ØµØ¨ÙˆØ±ÛŒ Ùˆ Ù‡Ù…Ø±Ø§Ù‡ÛŒâ€ŒØªØ§Ù† Ø³Ù¾Ø§Ø³Ú¯Ø²Ø§Ø±ÛŒÙ… ğŸ’›</p>
                {% endif %}
                <div class="invoice-header">
                    <div id="faktor-id">
                        <p> Ø´Ù…Ø§Ø±Ù‡ ÙØ§Ú©ØªÙˆØ± : {{ order.code }} </p>
                    </div>
                    <h1>ÙØ§Ú©ØªÙˆØ± Ø®Ø±ÛŒØ¯</h1>
                    <img src="/static/image/logo.png" alt="Ø¨Ù†Ø± ÙØ±ÙˆØ´Ú¯Ø§Ù‡">
                </div>
                <div class="order-date">
                    <p> ØªØ§Ø±ÛŒØ® : {{ order.updated|jformat:"%Y/%m/%d" }}</p>
                    <p> Ø³Ø§Ø¹Øª : {{ order.updated|jformat:"%H:%M:%S" }}</p>
                </div>
                <div class="invoice-info">
                    {{ order.address }}
                </div>

                <table class="invoice-table" id="olds-faktor">
                    <thead>
                    <tr>
                        <th>#</th>
                        <th>ØªØµÙˆÛŒØ±</th>
                        <th>Ù…Ø­ØµÙˆÙ„</th>
                        <th>Ø±Ù†Ú¯</th>
                        <th>Ø³Ø§ÛŒØ²</th>
                        <th>Ù‚ÛŒÙ…Øª ÙˆØ§Ø­Ø¯</th>
                        <th>ØªØ®ÙÛŒÙ ÙˆØ§Ø­Ø¯</th>
                        <th>ØªØ¹Ø¯Ø§Ø¯</th>
                        <th>Ù‚ÛŒÙ…Øª Ú©Ù„</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for item in order.items.all %}
                        <tr>
                        <tr>
                            <td data-label="#"><p class="golden">{{ forloop.counter }}</p></td>
                            <td data-label="ØªØµÙˆÛŒØ± :"><img id="fak-img" src="{{ item.product.product.image.url }}"
                                                          alt=""></td>
                            <td data-label="Ù…Ø­ØµÙˆÙ„ :">{{ item.product.product.title }} {{ item.product.product.model }} </td>
                            <td data-label="Ø±Ù†Ú¯ :">{{ item.product.color.title }} </td>
                            <td data-label="Ø³Ø§ÛŒØ² :">{{ item.product.size.title }} </td>
                            <td data-label="Ù‚ÛŒÙ…Øª ÙˆØ§Ø­Ø¯ :">{{ item.product.price|format_price }}</td>
                            <td data-label="ØªØ®ÙÛŒÙ ÙˆØ§Ø­Ø¯ :">{{ item.discount|format_price }}</td>
                            <td data-label="ØªØ¹Ø¯Ø§Ø¯ :">{{ item.quantity }}</td>
                            <td data-label="Ù‚ÛŒÙ…Øª Ú©Ù„ :">{{ item.price|format_price }}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                <div class="invoice-summary">
                    <div><strong>Ø¬Ù…Ø¹ Ú©Ù„:</strong> {{ order.get_total_items_price|format_price }} </div>
                    <div><strong>Ù‡Ø²ÛŒÙ†Ù‡ Ø§Ø±Ø³Ø§Ù„:</strong>
                        {% if order.shipping_method == 'pishteaz' %}
                            {{ order.get_shipping_price|format_price }}
                        {% else %}
                            <p>Ø¨Ù‡ Ø¹Ù‡Ø¯Ù‡ Ù…Ø´ØªØ±ÛŒ Ù…ÛŒØ¨Ø§Ø´Ø¯</p>
                        {% endif %}
                    </div>
                    <div class="final-price"><strong>Ù‚ÛŒÙ…Øª Ù†Ù‡Ø§ÛŒÛŒ:</strong> {{ order.get_final_price|format_price }}
                    </div>
                </div>
            </div>
        </div>

    {% empty %}
        <a class="empty-cart" href="{% url 'product_list_page' %}"><img src="/static/image/icons/empty-cart.jpg"
                                                                        alt="Ù„Ø¨Ø§Ø³ Ø¨Ú†Ù‡ Ø¢ØªÙˆØ³Ø§"></a>
    {% endfor %}
    <div class="pagination-container">
        {% if page_obj.has_previous %}
            <button class="pagination-btn" data-page="{{ page_obj.previous_page_number }}" data-status="{{ status }}">
                Ù‚Ø¨Ù„ÛŒ
            </button>
        {% endif %}

        {% for num in page_obj.paginator.page_range %}
            {% if num == page_obj.number %}
                <button class="pagination-btn active">{{ num }}</button>
            {% else %}
                <button class="pagination-btn" data-page="{{ num }}" data-status="{{ status }}">{{ num }}</button>
            {% endif %}
        {% endfor %}

        {% if page_obj.has_next %}
            <button class="pagination-btn" data-page="{{ page_obj.next_page_number }}" data-status="{{ status }}">
                Ø¨Ø¹Ø¯ÛŒ
            </button>
        {% endif %}
    </div>
{% endif %}